Практикум в продвинутом текстовом редакторе

# Поиск и замена. Регулярные выражения.

Что понадобится: NotePad++. Владельцы Mac-ов используют аналоги: редакторы TextWrangler или Fraise

## 1. Файл для работы - [dovlatov2.txt](http://hseinstruments.wikispaces.com/file/view/dovlatov2.txt/622086285/dovlatov2.txt)

Откройте файл с помощью NotePad++ (в проводнике контекстное меню "Открыть с помощью...")


## 2. Что нужно сделать:

    убрать ударения
    заменить прописные буквы строчными в заголовке
    заменить пробелы в начале абзацев на табуляцию
    убрать "жесткие" концы строк, оставив деление на абзацы
    при этом аккуратно обработать слова с переносами
    убрать "лишние" пробелы (два и больше)


## 3. Уберите все знаки ударения

Выделите символ ударения, меню Поиск → Замена,

Найти: `ˊ` Заменить: (оставьте пустым) Режим поиска: обычный Заменить всё

Преобразуйте заголовок, заменив прописные буквы строчными

Правка → Преобразовать выделение → строчные


## 4. Кодировки

Типы кодировок текста для русского языка:

DOS, KOI8-R, Cyrillic Windows cp1251, Unicode (UTF-8 с/без BOM, цифровой подписи)

В меню "Кодировки" замените текущую на Windows-1251 (оцените эффект:), затем обратно на UTF-8 без BOM.

Если вы открываете файл и видите "кракозябры", то с помощью меню "Кодировки" можно подобрать правильную.

"Преобразовать в...": переводит файл в другую кодировку (затем файл нужно сохранить). Windows-1251 называется ANSI.


## 5. Вид → Отображение символов

Отметьте чекбоксы: Отображать пробелы и табуляции, отображать символы конца строки (отображать все символы).


## 6. Формат конца строки

Непечатаемые символы, обозначающие конец строки:

Win-формат: CR+LF \r\n

old-Mac-формат: CR \r

UNIX-формат: LF \n

В режиме отображения символов конца строки вы увидите "СR", "LF", которые при поиске и замене в расширенном режиме и в режиме регулярных выражений задаются как эскейп-символы `\r`, `\n`, соответственно.


## 7. Вид → Перенос строк

автоматически переносит текст на новую строку, как в Word. Видимые концы строк при этом не сохраняются (являются "мягкими").


## 8. Поиск и замена в расширенном режиме

Табуляция: экскейп-символ `\t`

Замените 5 пробелов в начале строки на знак табуляции.

Найти: `˽˽˽˽˽` (5 пробелов)

Заменить: `\t` Режим поиска: расширенный


Замените концы строк на пробел

Найти: `\r\n` Заменить: `˽` (1 пробел). Режим поиска: расширенный

Верните концы строк в конце абзацев. (Догадайтесь, как). 
Подсказка: абзацы начинаются с табуляции. \t нужно заменить на нее же, но перед ней вставить......)


## 9. Режим поиска "Регулярные выражения"


`^` - начало строки, `$` - конец строки

`к[аоиу]т` - найдет _кат_, _кот_, _кит_, _кут_

`[а-яё]` - найдет все буквы русского алфавита

`[0-9a-z@_.]` - все знаки, допустимые в адресе электронной почты

Узнайте, есть ли в тексте латинские буквы?


`[^а-я]` - "крышка" обозначает НЕ

`[^!]$`- найдет концы абзацев, не заканчивающиеся на восклицательный знак


`.` - любой символ

`.+` - повтор (любого символа) 1 или более раз

`.*` - повтор (любого символа) 0 или более раз


`е+` - найдет _е_, _ее_, _еее_...

`[нм]+` - найдет сочетания _нн_, _мм_, _нм_, _мн_, _ммм_, _нннн_, _мнннннм_...

`л.+` - найдет букву _л_ и далее все символы до конца строки

`л[а-яё]+` - что найдется здесь?

`˽я[а-яё]*` - (в начале пробел) найдет слова, начинающиеся с _я_, в том числе слово _я_

Этот поиск "__жадный__" - он будет искать строку максимальной длины, соответствующую условию в "Искать".

Запрос `<.*>` в строке `<p>что-то здесь</p>` найдет всю строку целиком: `<p>что-то здесь</p>`

Нежадный ("__ленивый__") поиск:

`.+?`

`.*?`

-- ищет до первого вхождения символа, указанного после ?

`<.*?>` - найдет тег `<p>`, затем тег `<p>`: `<p>что-то здесь</p>`

`ч.+о` - найдет `"что-то"`

`ч.+?о` - найдет `"что"`



## 10. Найдите и замените "лишние" пробелы в тексте.

Найдите с помощью "ленивого поиска" последовательность букв от пробела до пробела (слово).


## 11. Регулярные выражения: эскейп-символы

`\.` - ищет точку

`\\` - ищет обратный слэш

`\+`, `\*`, `\[`, `\]`, `\(` - ищет плюс, звездочку, знаки скобок и т.п.


Найдите все концы абзацев, заканчивающиеся на точку.



## 12. Использование условий поиска

Заключите все условие или его части в скобки. В поле "Заменить"

`\1`, `\2`, `\3` - обозначает части поиска

`([^ -])- ([^ -])` → `\1\2` - уберет дефисы, оставшиеся после удаления жестких концов строк.

Задание: Задайте маску поиска конца прямой речи.

Подсказка: используйте `[ ]` со списком знаков препинания


## 13. Предупреждение: язык регулярных выражений может немного различаться в разных редакторах и в разных языках программирования (нотацией), но в целом набор приемов и принципы поиска одинаковы.

Шифр для знатоков: в NotePad++ нет: `{20,40}`, вместо `\0` использовать `\1`.

[Еще один краткий курс по регулярным выражениям в NotePad++](http://markantoniou.blogspot.ru/2008/06/notepad-how-to-use-regular-expressions.html)


## Дополнительное задание:
создайте список слов по вашему файлу.

0) сохраните содержимое файла в новый файл dovlatov_wordlist.txt  
1) переведите все слова в нижний регистр (Правка -> Конвертировать Регистр / Edit -> Convert case to...)   
2) сделайте так, чтобы каждое слово шло с новой строки, вставив концы строк  
3) сделайте так, чтобы каждый знак препинания также шел с новой строки  
4) отсортируйте строки по алфавиту (Правка -> Операции со строками -> Сортировать по возрастанию / Edit -> Line operations -> Sort lines lexicographically ascending).  
5) удалите повторяющиеся строки с помощью регулярных выражений  
    `^(.*\r\n)\1+` -> `\1`    


## Дополнительное задание 2: 
В файле с текстом разметьте начало и конец прямой речи с помощью тега <speech>, например, вот так:
```    
   -- <speech>Не думаю</speech>, -- сказал редактор, потом вдруг
рассердился, -- <speech>хватит!  Вечные отговорки!  Всё не как
у людей!  Извольте одеваться так, как подобает
работнику солидной газеты!</speech>
```
Сохраните файл как dovlatov_speech.txt.
